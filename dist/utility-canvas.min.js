!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),i.d(e,"UtilityCanvas",(function(){return r})),i.d(e,"clamp",(function(){return s})),i.d(e,"hexToRgb",(function(){return o}));const s=(t,e,i)=>Math.min(Math.max(e,t),i),o=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null};function r({canvas:t=document.createElement("canvas"),width:e=1024,height:i=1024,parent:s=null}={}){this.el=t,this.width=t.width=e,this.height=t.height=i,this.ctx=t.ctx=t.getContext("2d"),s&&s.appendChild(t)}r.prototype.resize=function({width:t=this.width,height:e=this.height}){return this.width=this.el.width=t,this.height=this.el.height=e,this},r.prototype.clearRect=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height}={}){return this.ctx.clearRect(t,e,i,s),this},r.prototype.clear=function(){return this.clearRect()},r.prototype._parseSettings=function(t){if(!t)return this;const{color:e,strokeOptions:i={},alpha:s,operation:o}=t;return this.setColor(e),this.setStroke(i),this.setAlpha(s),this.setCompositeOperation(o),this},r.prototype.setColor=function(t=this.ctx.fillStyle){return this.ctx.fillStyle=t,this},r.prototype.setStroke=function({thickness:t=this.ctx.lineWidth,color:e=this.ctx.strokeStyle}={}){return this.ctx.lineWidth=t,this.ctx.strokeStyle=e,this},r.prototype.setCompositeOperation=function(t=this.ctx.globalCompositeOperation){return r.COMPOSITE[t]?this.ctx.globalCompositeOperation=r.COMPOSITE[t]:Object.values(r.COMPOSITE).includes(t)?this.ctx.globalCompositeOperation=t:console.warn(`Composite operation: '${t}' does not exist.`),this},r.prototype.setAlpha=function(t=this.ctx.globalAlpha){return this.ctx.globalAlpha=t,this},r.prototype.fill=function(t){return this.ctx.save(),this._parseSettings(t),this.ctx.fill(),this.ctx.restore(),this},r.prototype.fillRect=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height,...o}={}){return this.ctx.save(),this._parseSettings(o),this.ctx.fillRect(t,e,i,s),this.ctx.restore(),this},r.prototype.fillColor=function(t){return this.fillRect(t)},r.prototype.fillImage=function(t,{preserveAspect:e=!1,...i}={}){return e?this.fillOrFitImage(t,{fill:"fill"===e,...i}):(this.ctx.save(),this._parseSettings(i),this.ctx.drawImage(t,0,0,this.width,this.height),this.ctx.restore(),this)},r.prototype.fillOrFitImage=function(t,{fill:e=!0,aspect:i=null,anchors:{x:s="center",y:o="center"}={},offset:{x:r=0,y:h=0}={},margin:n={t:0,l:0,r:0,b:0},...c}={}){i=i||(t.height||t.naturalHeight)/(t.width||t.naturalWidth),"number"==typeof n&&(n={t:n,l:n,r:n,b:n});const{t:a=0,l:l=0,r:p=0,b:u=0}=n,f=this.width-l-p,g=this.height-a-u;this.ctx.save(),this._parseSettings(c);const x=i/(g/f);if(1===x)this.ctx.drawImage(t,r+l,h+a,f,g);else if(x>1===e){const e=f*i,s="bottom"===o?g-e:"top"===o?0:(g-e)/2;this.ctx.drawImage(t,r+l,s+h+a,f,e)}else{const e=g/i,o="right"===s?f-e:"left"===s?0:(f-e)/2;this.ctx.drawImage(t,o+r+l,h+a,e,g)}return this.ctx.restore(),this},r.prototype.fillPattern=function(t,{aspect:e=null,repeat:i=null,offset:{x:s=0,y:o=0}={},margin:{x:r=0,y:h=0}={},anchors:{x:n="center",y:c="center"}={},...a}={}){e=e||(t.height||t.naturalHeight)/(t.width||t.naturalWidth),i=i||{x:this.width/((t.width||t.naturalWidth)+r),y:this.height/((t.height||t.naturalHeight)+h)};const l=this.width/i.x,p=this.height/i.y;"center"===n?s-=(Math.ceil(i.x)*l+r-this.width)/2:"right"===n&&(s-=Math.ceil(i.x)*l+r-this.width),"center"===c?o-=(Math.ceil(i.y)*p+h-this.height)/2:"bottom"===c&&(o-=Math.ceil(i.y)*p+h-this.height),this.ctx.save(),this._parseSettings(a);for(let e=0;e<i.x;e++){let n=r+e*l;for(let e=0;e<i.y;e++)this.ctx.drawImage(t,s+n,o+h+e*p,l-r,p-h)}return this.ctx.restore(),this},r.prototype.beginPath=function(){return this.ctx.beginPath(),this},r.prototype.stroke=function(t){return this.ctx.save(),this._parseSettings(t),this.ctx.stroke(),this.ctx.restore(),this},r.prototype.closePath=function(){return this.ctx.closePath(),this},r.prototype.rectangle=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height,fill:o=!1,stroke:r=!1,...h}){return this.ctx.save(),this._parseSettings(h),o||r||h.color||h.strokeOptions?(this.ctx.beginPath(),this.ctx.rect(t,e,i,s),this.ctx.closePath(),(o||h.color)&&this.fill(o),(r||h.strokeOptions)&&this.stroke(r)):this.ctx.rect(t,e,i,s),this.ctx.restore(),this},r.prototype.arc=function({center:{x:t=this.width/2,y:e=this.height/2}={},radius:i=Math.min(this.width,this.height)/2,startAngle:s=0,endAngle:o=2*Math.PI,cc:r=!1,fill:h=!1,stroke:n=!1,...c}){return this.ctx.save(),this._parseSettings(c),h||n||c.color||c.strokeOptions?(this.ctx.beginPath(),this.ctx.arc(t,e,i,s,o,r),this.ctx.closePath(),(h||c.color)&&this.fill(h),(n||c.strokeOptions)&&this.stroke(n)):this.ctx.arc(t,e,i,s,o,r),this.ctx.restore(),this},r.prototype.ellipse=function({center:{x:t=this.width/2,y:e=this.height/2}={},radius:{x:i=this.width/2,y:s=this.height/2}={},rotation:o=0,startAngle:r=0,endAngle:h=2*Math.PI,cc:n=!1,fill:c=!1,stroke:a=!1,...l}){return this.ctx.save(),this._parseSettings(l),c||a||l.color||l.strokeOptions?(this.ctx.beginPath(),this.ctx.ellipse(t,e,i,s,o,r,h,n),this.ctx.closePath(),(c||l.color)&&this.fill(c),(a||l.strokeOptions)&&this.stroke(a)):this.ctx.ellipse(t,e,i,s,o,r,h,n),this.ctx.restore(),this},r.prototype.roundedRectangle=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height,radius:o,fill:r=!1,stroke:h=!1,...n}){"number"==typeof o&&(o={tl:o,tr:o,bl:o,br:o});const{tl:c,tr:a,bl:l,br:p}=o;return this.ctx.save(),this._parseSettings(n),this.ctx.beginPath(),this.ctx.moveTo(t+c,e),this.ctx.lineTo(t+i-a,e),this.ctx.arc(t+i-a,e+a,a,Math.PI/2,0),this.ctx.lineTo(t+i,e+s-p),this.ctx.arc(t+i-p,e+s-p,p,0,Math.PI/2),this.ctx.lineTo(t+l,e+s),this.ctx.arc(t+l,e+s-l,l,-Math.PI/2,-Math.PI),this.ctx.lineTo(t,e+c),this.ctx.arc(t+c,e+c,c,Math.PI,Math.PI/2),this.ctx.closePath(),(r||n.color)&&this.fill(r),(h||n.strokeOptions)&&this.stroke(h),this.ctx.restore(),this},r.prototype.polygon=function(t=[],{closed:e=!0,fill:i=!1,stroke:s=!1,...o}={}){if(!Array.isArray(t)||!t.length)return this;this.ctx.save(),this._parseSettings(o),this.ctx.beginPath(),this.ctx.moveTo(...t[0]);for(let e=1;e<t.length;e++)this.ctx.lineTo(...t[e]);return(e||i||o.color)&&(this.ctx.closePath(),(i||o.color)&&this.fill(i)),(s||o.strokeOptions)&&this.stroke(s),this.ctx.restore(),this},r.prototype.line=function(t=[],{closed:e=!1,stroke:i=!0,...s}={}){return this.polygon(t,{closed:e,stroke:i,...s})},r.prototype.drawImage=function(t,{position:{x:e=0,y:i=0}={},rotation:s=0,scale:o=1,...r}){return this.ctx.save(),this._parseSettings(r),this.ctx.translate(e,i),this.ctx.rotate(s),this.ctx.drawImage(t,-t.width*o/2,-t.height*o/2,t.width*o,t.height*o),this.ctx.restore(),this},r.prototype.clear=function(){return this.ctx.clearRect(0,0,this.width,this.height),this},r.prototype.clear=function(){return this.ctx.clearRect(0,0,this.width,this.height),this},r.prototype.chromaKey=function(t,e=.01){const i="string"==typeof t?o(t):t;if(!i)return console.error("Invalid color value: "+t),this;e=195075*Math.pow(s(e,.01,1),2);const r=this.ctx.getImageData(0,0,this.width,this.height);let h;for(let t=0;t<r.data.length;t+=4)h=Math.pow(r.data[t]-i.r,2)+Math.pow(r.data[t+1]-i.g,2)+Math.pow(r.data[t+2]-i.b,2),h<=e&&(r.data[t+3]=0);return this.ctx.putImageData(r,0,0),this},r.prototype.download=function(t="image/jpeg",e="export.jpg"){const i=document.createElement("a");i.href=this.getDataURL(t),i.download=e,i.click()},r.prototype.getDataURL=function(t="image/jpeg",e=1){return this.el.toDataURL(t,e)},r.prototype.setDataURL=function(t){const e=this,i=new Image;return new Promise(s=>{i.onload=()=>{e.fillImage(i),s()},i.src=t})},Object.defineProperty(r,"COMPOSITE",{value:{SOURCE_OVER:"source-over",OVERWRITE:"source-over",SOURCE_IN:"source-in",INTERSECT_REPLACE:"source-in",SOURCE_OUT:"source-out",AVOID_REPLACE:"source-out",SOURCE_ATOP:"source-atop",INTERSECT_ALPHA:"source-atop",DESTINATION_OVER:"destination-over",BEHIND:"destination-over",DESTINATION_IN:"destination-in",MASK:"destination-in",DESTINATION_OUT:"destination-out",REMOVE:"destination-out",DESTINATION_ATOP:"destination-atop",MASK_BEHIND:"destination-atop",LIGHTER:"lighter",ADD:"lighter",COPY:"copy",REPLACE:"copy",XOR:"xor",MULTIPLY:"multiply",SCREEN:"screen",DIVIDE:"screen",OVERLAY:"overlay",EXAGGERATE:"overlay",DARKEN:"darken",MIN:"darken",LIGHTEN:"lighten",MAX:"lighten",COLOR_DODGE:"color-dodge",COLOR_BURN:"color-burn",HARD_LIGHT:"hard-light",SOFT_LIGHT:"soft-light",DIFFERENCE:"difference",EXCLUSION:"exclusion",HUE:"hue",SATURATION:"saturation",COLOR:"color",LUMINOSITY:"luminosity"},writable:!1,enumerable:!0}),window.UtilityCanvas=r;e.default=r}]);