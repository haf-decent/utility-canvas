!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),i.d(e,"UtilityCanvas",(function(){return o})),i.d(e,"clamp",(function(){return s})),i.d(e,"hexToRgb",(function(){return r}));const s=(t,e,i)=>Math.min(Math.max(e,t),i),r=t=>{const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null};function o({canvas:t=document.createElement("canvas"),width:e=1024,height:i=1024,parent:s=null}={}){this.el=t,this.width=t.width=e,this.height=t.height=i,this.ctx=t.ctx=t.getContext("2d"),s&&s.appendChild(t)}o.prototype.resize=function({width:t=this.width,height:e=this.height}){return this.width=this.el.width=t,this.height=this.el.height=e,this},o.prototype.clearRect=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height}={}){return this.ctx.clearRect(t,e,i,s),this},o.prototype.clear=function(){return this.clearRect()},o.prototype._parseSettings=function(t){if(!t)return this;const{color:e,strokeOptions:i={},alpha:s,operation:r}=t;return this.setColor(e),this.setStroke(i),this.setAlpha(s),this.setCompositeOperation(r),this},o.prototype.setColor=function(t=this.ctx.fillStyle){return this.ctx.fillStyle=t,this},o.prototype.setStroke=function({thickness:t=this.ctx.lineWidth,color:e=this.ctx.strokeStyle}={}){return this.ctx.lineWidth=t,this.ctx.strokeStyle=e,this},o.prototype.setCompositeOperation=function(t=this.ctx.globalCompositeOperation){return o.COMPOSITE[t]?this.ctx.globalCompositeOperation=o.COMPOSITE[t]:Object.values(o.COMPOSITE).includes(t)?this.ctx.globalCompositeOperation=t:console.warn(`Composite operation: '${t}' does not exist.`),this},o.prototype.setAlpha=function(t=this.ctx.globalAlpha){return this.ctx.globalAlpha=t,this},o.prototype.fill=function(t){return this.ctx.save(),this._parseSettings(t),this.ctx.fill(),this.ctx.restore(),this},o.prototype.fillRect=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height,...r}={}){return this.ctx.save(),this._parseSettings(r),this.ctx.fillRect(t,e,i,s),this.ctx.restore(),this},o.prototype.fillColor=function(t){return this.fillRect(t)},o.prototype.fillImage=function(t,{preserveAspect:e=!1,...i}={}){return e?this.fillOrFitImage(t,{fill:"fill"===e,...i}):(this.ctx.save(),this._parseSettings(i),this.ctx.drawImage(t,0,0,this.width,this.height),this.ctx.restore(),this)},o.prototype.fillOrFitImage=function(t,{fill:e=!0,aspect:i=null,anchors:{x:s="center",y:r="center"}={},offset:{x:o=0,y:h=0}={},margin:n={t:0,l:0,r:0,b:0},...c}={}){i=i||(t.naturalHeight||t.height)/(t.naturalWidth||t.width),"number"==typeof n&&(n={t:n,l:n,r:n,b:n});const{t:a=0,l:l=0,r:u=0,b:p=0}=n,f=this.width-l-u,x=this.height-a-p;this.ctx.save(),this._parseSettings(c);const g=i/(x/f);if(1===g)this.ctx.drawImage(t,o+l,h+a,f,x);else if(g>1===e){const e=f*i,s="bottom"===r?x-e:"top"===r?0:(x-e)/2;this.ctx.drawImage(t,o+l,s+h+a,f,e)}else{const e=x/i,r="right"===s?f-e:"left"===s?0:(f-e)/2;this.ctx.drawImage(t,r+o+l,h+a,e,x)}return this.ctx.restore(),this},o.prototype.beginPath=function(){return this.ctx.beginPath(),this},o.prototype.stroke=function(t){return this.ctx.save(),this._parseSettings(t),this.ctx.stroke(),this.ctx.restore(),this},o.prototype.closePath=function(){return this.ctx.closePath(),this},o.prototype.rectangle=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height,fill:r=!1,stroke:o=!1,...h}){return this.ctx.save(),this._parseSettings(h),r||o?(this.ctx.beginPath(),this.ctx.rect(t,e,i,s),this.ctx.closePath(),r&&this.fill(r),o&&this.stroke(o)):this.ctx.rect(t,e,i,s),this.ctx.restore(),this},o.prototype.arc=function({center:{x:t=this.width/2,y:e=this.height/2}={},radius:i=Math.min(this.width,this.height)/2,startAngle:s=0,endAngle:r=2*Math.PI,cc:o=!1,fill:h=!1,stroke:n=!1,...c}){return this.ctx.save(),this._parseSettings(c),h||n?(this.ctx.beginPath(),this.ctx.arc(t,e,i,s,r,o),this.ctx.closePath(),h&&this.fill(h),n&&this.stroke(n)):this.ctx.arc(t,e,i,s,r,o),this.ctx.restore(),this},o.prototype.ellipse=function({center:{x:t,y:e},radius:{x:i,y:s},rotation:r=0,startAngle:o=0,endAngle:h=2*Math.PI,cc:n=!1,fill:c=!1,stroke:a=!1,...l}){return this.ctx.save(),this._parseSettings(l),c||a?(this.ctx.beginPath(),this.ctx.ellipse(t,e,i,s,r,o,h,n),this.ctx.closePath(),c&&this.fill(c),a&&this.stroke(a)):this.ctx.ellipse(t,e,i,s,r,o,h,n),this.ctx.restore(),this},o.prototype.roundedRectangle=function({offset:{x:t=0,y:e=0}={},width:i=this.width,height:s=this.height,radius:r,fill:o=!1,stroke:h=!1,...n}){"number"==typeof r&&(r={tl:r,tr:r,bl:r,br:r});const{tl:c,tr:a,bl:l,br:u}=r;return this.ctx.save(),this._parseSettings(n),this.ctx.beginPath(),this.ctx.moveTo(t+c,e),this.ctx.lineTo(t+i-a,e),this.ctx.arc(t+i-a,e+a,a,Math.PI/2,0),this.ctx.lineTo(t+i,e+s-u),this.ctx.arc(t+i-u,e+s-u,u,0,Math.PI/2),this.ctx.lineTo(t+l,e+s),this.ctx.arc(t+l,e+s-l,l,-Math.PI/2,-Math.PI),this.ctx.lineTo(t,e+c),this.ctx.arc(t+c,e+c,c,Math.PI,Math.PI/2),this.ctx.closePath(),o&&this.fill(o),h&&this.stroke(h),this.ctx.restore(),this},o.prototype.polygon=function(t=[],{closed:e=!0,fill:i=!1,stroke:s=!1,...r}={}){if(!Array.isArray(t)||!t.length)return this;this.ctx.save(),this._parseSettings(r),this.ctx.beginPath(),this.ctx.moveTo(t[0]);for(let e=1;e<t.length;e++)this.ctx.lineTo(t[e]);return(e||i)&&(this.ctx.closePath(),i&&this.fill(i)),s&&this.stroke(s),this.ctx.restore(),this},o.prototype.drawImage=function(t,{position:{x:e=0,y:i=0}={},rotation:s=0,scale:r=1,...o}){return this.ctx.save(),this._parseSettings(o),this.ctx.translate(e,i),this.ctx.rotate(s),this.ctx.drawImage(t,-t.width*r/2,-t.height*r/2,t.width*r,t.height*r),this.ctx.restore(),this},o.prototype.clear=function(){return this.ctx.clearRect(0,0,this.width,this.height),this},o.prototype.clear=function(){return this.ctx.clearRect(0,0,this.width,this.height),this},o.prototype.chromaKey=function(t,e=.01){const i="string"==typeof t?r(t):t;if(!i)return console.error("Invalid color value: "+t),this;e=195075*Math.pow(s(e,.01,1),2);const o=this.ctx.getImageData(0,0,this.width,this.height);let h;for(let t=0;t<o.data.length;t+=4)h=Math.pow(o.data[t]-i.r,2)+Math.pow(o.data[t+1]-i.g,2)+Math.pow(o.data[t+2]-i.b,2),h<=e&&(o.data[t+3]=0);return this.ctx.putImageData(o,0,0),this},o.prototype.download=function(t="image/jpeg",e="export.jpg"){const i=document.createElement("a");i.href=this.getDataURL(t),i.download=e,i.click()},o.prototype.getDataURL=function(t="image/jpeg",e=1){return this.el.toDataURL(t,e)},o.prototype.setDataURL=function(t){const e=this,i=new Image;return new Promise(s=>{i.onload=()=>{e.fillImage(i),s()},i.src=t})},Object.defineProperty(o,"COMPOSITE",{value:{SOURCE_OVER:"source-over",OVERWRITE:"source-over",SOURCE_IN:"source-in",INTERSECT_REPLACE:"source-in",SOURCE_OUT:"source-out",AVOID_REPLACE:"source-out",SOURCE_ATOP:"source-atop",INTERSECT_ALPHA:"source-atop",DESTINATION_OVER:"destination-over",BEHIND:"destination-over",DESTINATION_IN:"destination-in",MASK:"destination-in",DESTINATION_OUT:"destination-out",REMOVE:"destination-out",DESTINATION_ATOP:"destination-atop",MASK_BEHIND:"destination-atop",LIGHTER:"lighter",ADD:"lighter",COPY:"copy",REPLACE:"copy",XOR:"xor",MULTIPLY:"multiply",SCREEN:"screen",DIVIDE:"screen",OVERLAY:"overlay",EXAGGERATE:"overlay",DARKEN:"darken",MIN:"darken",LIGHTEN:"lighten",MAX:"lighten",COLOR_DODGE:"color-dodge",COLOR_BURN:"color-burn",HARD_LIGHT:"hard-light",SOFT_LIGHT:"soft-light",DIFFERENCE:"difference",EXCLUSION:"exclusion",HUE:"hue",SATURATION:"saturation",COLOR:"color",LUMINOSITY:"luminosity"},writable:!1,enumerable:!0}),window.UtilityCanvas=o;e.default=o}]);